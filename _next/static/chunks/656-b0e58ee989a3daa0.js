"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[656],{1173:function(e,t,a){a.d(t,{N:function(){return E}});var r=a(7437),i=a(2265),l=a(9343),n=a(1014),s=a(537),o=a(2904);let c=s.Ry({fullName:s.Z_().min(2),preferredName:s.Z_().optional(),email:s.Z_().email(),phone:s.Z_().regex(/^\+?[1-9]\d{7,14}$/,"Invalid phone number").optional().or(s.i0("")),role:s.Km(["Mentor","Mentee","Both"]),occupation:s.Km(o.YA),gender:s.Km(o.mb).optional(),councilNumber:s.Z_().regex(/^[A-Za-z0-9\-]{4,20}$/,"Invalid council number").optional().or(s.i0("")),yearsQualified:s.Rx().int().min(0).max(50),stage:s.Km(o.eO),province:s.Km(o.Fd),city:s.Z_().min(2),facilityType:s.Km(o.tD),languages:s.IX(s.Km(o.a2)).min(1),specialties:s.IX(s.Z_()).min(1),interests:s.IX(s.Z_()).default([]),bioShort:s.Z_().max(280),bioLong:s.Z_().max(2e3).optional(),photoUrl:s.Z_().url().optional(),education:s.IX(s.Ry({institution:s.Z_(),graduationYear:s.Z_().regex(/^(19|20)\d{2}$/)})),experience:s.IX(s.Ry({organisation:s.Z_(),role:s.Z_(),startDate:s.Z_(),endDate:s.Z_().optional()})),certifications:s.IX(s.Z_()).optional(),links:s.Ry({linkedin:s.Z_().url().optional(),website:s.Z_().url().optional(),calendar:s.Z_().url().optional(),research:s.Z_().url().optional()}).optional(),discoverable:s.O7().default(!0),consentShareProfile:s.O7().default(!1),meetingModes:s.IX(s.Km(o.nI)).min(1),mentorshipStyle:s.Km(o.SJ).optional(),mentorPreferences:s.Ry({capacity:s.Rx().int().min(1).max(20),expectedCommitment:s.Z_().optional(),preferredDays:s.IX(s.Z_()).default([]),preferredTimes:s.IX(s.Z_()).default([]),locations:s.IX(s.Z_()).default([])}).optional(),menteeGoals:s.IX(s.Z_()).default([]),menteeAvailability:s.IX(s.Z_()).default([]),meetingModePreference:s.Km(o.nI).optional(),mentorshipGoals:s.IX(s.Ry({title:s.Z_(),description:s.Z_().optional()})).optional(),consentedPolicies:s.O7(),ageConfirmed:s.O7()});s.Ry({receiverUserId:s.Z_(),message:s.Z_().min(10),goals:s.IX(s.Z_()).min(1)}),s.Ry({matchId:s.Z_(),body:s.Z_().min(1),type:s.Km(["text","image","file"]).default("text")}),s.Ry({targetUserId:s.Z_(),category:s.Z_(),details:s.Z_().min(10)}),s.Ry({roleWanted:s.Km(["Mentor","Mentee","Both"]).optional(),occupation:s.Z_().optional(),province:s.Z_().optional(),gender:s.Km(o.mb).optional(),languages:s.IX(s.Z_()).optional(),specialties:s.IX(s.Z_()).optional(),virtualOnly:s.O7().optional(),availableDay:s.Z_().optional()});var d=a(3102),u=a(4655);let m=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("textarea",{className:(0,u.cn)("flex w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm shadow-sm transition-all placeholder:text-slate-400 focus-visible:border-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-200",a),ref:t,...i})});m.displayName="Textarea";var h=a(495),p=a(9324),f=a(2468);let x=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(p.fC,{ref:t,className:(0,u.cn)("peer h-5 w-5 shrink-0 rounded-md border border-slate-300 bg-white shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 disabled:cursor-not-allowed disabled:opacity-50",a),...i,children:(0,r.jsx)(p.z$,{className:"flex items-center justify-center text-brand-600",children:(0,r.jsx)(f.Z,{className:"h-4 w-4"})})})});x.displayName=p.fC.displayName;var g=a(6294),v=a(7135);function y(e){let{value:t}=e;return(0,r.jsx)("div",{className:"h-2 w-full rounded-full bg-slate-200",children:(0,r.jsx)("div",{className:(0,u.cn)("h-2 rounded-full bg-brand-500 transition-all"),style:{width:"".concat(t,"%")}})})}var b=a(6648),w=a(2746),j=a(7776);function N(e){let{value:t,onChange:a,label:l="Profile photo"}=e,n=(0,i.useRef)(null),{user:s}=(0,w.a)(),[o,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),[m,p]=(0,i.useState)(null),[f,x]=(0,i.useState)(null),[g,v]=(0,i.useState)(1),[y,N]=(0,i.useState)(0),[S,C]=(0,i.useState)(0),_=(0,i.useRef)(null),[I,P]=(0,i.useState)(!1),R=(0,i.useRef)(null),M=e=>new Promise((t,a)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=()=>a(Error("Failed to read file")),r.readAsDataURL(e)}),E=(0,i.useCallback)(()=>{if(!m||!f||!_.current)return;let e=_.current,t=e.getContext("2d");if(!t)return;let a=new window.Image;a.onload=()=>{let r=Math.min(f.w,f.h)/g,i=Math.max(0,Math.min(y,f.w-r)),l=Math.max(0,Math.min(S,f.h-r));t.clearRect(0,0,e.width,e.height),t.drawImage(a,i,l,r,r,0,0,e.width,e.height)},a.src=m},[m,f,y,S,g]),k=(0,i.useCallback)((e,t)=>{if(!f)return{sx:e,sy:t};let a=Math.min(f.w,f.h)/g;return{sx:Math.max(0,Math.min(e,Math.max(0,f.w-a))),sy:Math.max(0,Math.min(t,Math.max(0,f.h-a)))}},[f,g]),F=(0,i.useCallback)(e=>{m&&f&&(P(!0),R.current={x:e.clientX,y:e.clientY},e.currentTarget.setPointerCapture(e.pointerId))},[m,f]),Z=(0,i.useCallback)(e=>{if(!I||!R.current||!f||!_.current)return;e.preventDefault();let t=e.clientX-R.current.x,a=e.clientY-R.current.y,r=_.current,i=Math.min(f.w,f.h)/g/(r.width||240),l=k(y-t*i,S-a*i);N(l.sx),C(l.sy),R.current={x:e.clientX,y:e.clientY}},[I,f,y,S,g,k]),A=(0,i.useCallback)(e=>{P(!1),R.current=null;try{e.currentTarget.releasePointerCapture(e.pointerId)}catch(e){}},[]);(0,i.useEffect)(()=>{E()},[E]);let T=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(!a.type.startsWith("image/")){j.Am.error("Please select an image file");return}if(a.size>5242880){j.Am.error("Image is too large (max 5MB)");return}try{let e=await M(a),t=new window.Image;t.onload=()=>{x({w:t.naturalWidth,h:t.naturalHeight});let a=Math.min(t.naturalWidth,t.naturalHeight);v(1),N((t.naturalWidth-a)/2),C((t.naturalHeight-a)/2),p(e)},t.src=e}catch(e){j.Am.error("Failed to load image")}}},U=async()=>{if(m&&f){if(!(null==s?void 0:s.uid)){j.Am.error("You must be signed in to upload a photo");return}try{c(!0);let e=new window.Image,t=await new Promise((t,a)=>{e.onload=()=>{let r=document.createElement("canvas");r.width=512,r.height=512;let i=r.getContext("2d");if(!i)return a(Error("Canvas not supported"));let l=Math.min(f.w,f.h)/g,n=Math.max(0,Math.min(y,f.w-l)),s=Math.max(0,Math.min(S,f.h-l));i.drawImage(e,n,s,l,l,0,0,512,512),r.toBlob(e=>e?t(e):a(Error("Failed to crop")),"image/jpeg",.9)},e.onerror=()=>a(Error("Failed to load image")),e.src=m}),r=URL.createObjectURL(t);u(r);let i=new FormData;i.append("file",t,"profile.jpg");let l=await fetch("/api/upload/image",{method:"POST",body:i});if(!l.ok)throw Error("Upload failed");let{url:n}=await l.json();a(n),p(null),j.Am.success("Profile photo uploaded")}catch(e){console.error(e),j.Am.error("Failed to upload photo")}finally{c(!1)}}},B=d||t||null;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-700",children:l}),m&&f?(0,r.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,r.jsx)("div",{className:"relative h-60 w-60 overflow-hidden rounded-xl border border-slate-200 bg-slate-50 select-none touch-none ".concat(I?"cursor-grabbing":"cursor-grab"),onPointerDown:F,onPointerMove:Z,onPointerUp:A,onPointerCancel:A,children:(0,r.jsx)("canvas",{ref:_,width:240,height:240,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-3",children:[(0,r.jsxs)("label",{className:"text-xs text-slate-600",children:["Zoom",(0,r.jsx)("input",{type:"range",min:1,max:3,step:.01,value:g,onChange:e=>v(Number(e.target.value)),className:"mt-1 w-full"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("label",{className:"flex-1 text-xs text-slate-600",children:["Position X",(0,r.jsx)("input",{type:"range",min:0,max:Math.max(0,f.w-Math.min(f.w,f.h)/g),step:1,value:y,onChange:e=>N(Number(e.target.value)),className:"mt-1 w-full"})]}),(0,r.jsxs)("label",{className:"flex-1 text-xs text-slate-600",children:["Position Y",(0,r.jsx)("input",{type:"range",min:0,max:Math.max(0,f.h-Math.min(f.w,f.h)/g),step:1,value:S,onChange:e=>C(Number(e.target.value)),className:"mt-1 w-full"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(h.z,{type:"button",onClick:U,disabled:o,children:o?"Uploading…":"Save crop"}),(0,r.jsx)(h.z,{type:"button",variant:"outline",onClick:()=>{p(null)},disabled:o,children:"Cancel"})]})]})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"relative h-20 w-20 overflow-hidden rounded-full bg-slate-100",children:B?B.startsWith("blob:")?(0,r.jsx)("img",{src:B,alt:"Profile photo",className:"h-full w-full object-cover"}):(0,r.jsx)(b.default,{src:B,alt:"Profile photo",fill:!0,className:"object-cover",sizes:"80px"}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center text-xs text-slate-500",children:"No photo"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{ref:n,type:"file",accept:"image/*",className:"hidden",onChange:T}),(0,r.jsx)(h.z,{type:"button",onClick:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.click()},disabled:o,children:o?"Uploading…":B?"Change photo":"Upload photo"}),B&&(0,r.jsx)(h.z,{type:"button",variant:"outline",onClick:()=>{(d||t)&&window.confirm("Remove your profile photo?")&&(a(null),u(null))},disabled:o,children:"Remove"})]})]}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"JPG or PNG up to 5MB."})]})]})}var S=a(1823),C=a(5524),_=a(6463);let I=["Musculoskeletal","Neurology","Paediatrics","Cardio-respiratory","Sports","Geriatrics","Mental Health","Community Rehab","Hospital Pharmacy","Community Pharmacy","Regulatory Affairs","Radiography","Rehabilitation"],P={fullName:"",preferredName:"",email:"",phone:"",role:"Mentee",occupation:"Physiotherapist",gender:void 0,councilNumber:"",yearsQualified:0,stage:"Community Service",province:"GP",city:"",facilityType:"Clinic",languages:["English"],specialties:["Musculoskeletal"],interests:[],bioShort:"",bioLong:"",education:[],experience:[],certifications:[],links:{linkedin:void 0,website:void 0,calendar:void 0,research:void 0},discoverable:!0,consentShareProfile:!1,meetingModes:["Virtual"],mentorshipStyle:"Collaborative",mentorPreferences:{capacity:1,expectedCommitment:"",preferredDays:[],preferredTimes:[],locations:[]},menteeGoals:[],menteeAvailability:[],meetingModePreference:"Virtual",mentorshipGoals:[],consentedPolicies:!1,ageConfirmed:!1},R=[{id:0,label:"Basics"},{id:1,label:"Professional"},{id:2,label:"Mentorship"},{id:3,label:"Safety"}],M={0:["fullName","email","phone","role","occupation","gender"],1:["province","city","facilityType","languages","specialties","bioShort","photoUrl"],2:["mentorshipStyle","meetingModes","mentorPreferences.capacity"],3:["consentedPolicies","ageConfirmed"]};function E(e){var t,a,s,u,p,f,b,w,E;let{profile:k,mode:F="onboarding"}=e,[Z,A]=(0,i.useState)(0),T=(0,_.useRouter)(),U=(0,l.cI)({resolver:(0,n.F)(c),defaultValues:k?{...P,...k}:P}),B=null!==(b=U.watch("consentedPolicies"))&&void 0!==b&&b,D=null!==(w=U.watch("ageConfirmed"))&&void 0!==w&&w,L=(0,C.D)({mutationFn:async e=>{let t=await fetch("/api/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({error:"Unknown error"}));throw console.error("Profile save failed:",t.status,e),Error(e.error||"Server error: ".concat(t.status))}return t.json()},onSuccess:()=>{j.Am.success("edit"===F?"Profile updated successfully.":"Profile saved. Welcome to MentorMatch SA!"),T.push("edit"===F?"/profile":"/discover")},onError:e=>{console.error("Profile mutation error:",e);let t=e instanceof Error?e.message:"Could not save profile";j.Am.error(t)}}),O=async()=>{var e;let t=null!==(e=M[Z])&&void 0!==e?e:[];if(t.length&&!await U.trigger(t,{shouldFocus:!0})){j.Am.error("Please complete the required fields before continuing.");return}A(e=>Math.min(e+1,R.length-1))},V=U.handleSubmit(e=>L.mutate(e),()=>{j.Am.error("Please fix the highlighted fields before continuing.")}),X=(Z+1)/R.length*100;return(0,r.jsxs)("form",{onSubmit:V,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-brand-600",children:"Onboarding"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:null===(t=R[Z])||void 0===t?void 0:t.label})]}),(0,r.jsxs)("span",{className:"text-sm text-slate-500",children:["Step ",Z+1," of ",R.length]})]}),(0,r.jsx)(y,{value:X})]}),0===Z&&(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 animate-fade-slide",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"fullName",children:"Full name"}),(0,r.jsx)(d.I,{id:"fullName",...U.register("fullName")}),(0,r.jsx)("p",{className:"text-xs text-red-500",children:null===(a=U.formState.errors.fullName)||void 0===a?void 0:a.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"preferredName",children:"Preferred name"}),(0,r.jsx)(d.I,{id:"preferredName",...U.register("preferredName")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(d.I,{id:"email",type:"email",...U.register("email")}),(0,r.jsx)("p",{className:"text-xs text-red-500",children:null===(s=U.formState.errors.email)||void 0===s?void 0:s.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"phone",children:"Phone"}),(0,r.jsx)(d.I,{id:"phone",placeholder:"+27",...U.register("phone")}),(0,r.jsx)("p",{className:"text-xs text-red-500",children:null===(u=U.formState.errors.phone)||void 0===u?void 0:u.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{children:"Role"}),(0,r.jsx)("div",{className:"flex gap-3",children:["Mentor","Mentee","Both"].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-4 py-2",children:[(0,r.jsx)("input",{type:"radio",value:e,...U.register("role")}),(0,r.jsx)("span",{className:"text-sm",children:e})]},e))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{children:"Gender"}),(0,r.jsx)("div",{className:"flex gap-3",children:["Male","Female"].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-4 py-2",children:[(0,r.jsx)("input",{type:"radio",value:e,...U.register("gender")}),(0,r.jsx)("span",{className:"text-sm",children:e})]},e))}),(0,r.jsx)("p",{className:"text-xs text-red-500",children:null===(p=U.formState.errors.gender)||void 0===p?void 0:p.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"occupation",children:"Occupation"}),(0,r.jsxs)(g.Ph,{value:U.watch("occupation"),onValueChange:e=>U.setValue("occupation",e),children:[(0,r.jsx)(g.i4,{children:(0,r.jsx)(g.ki,{placeholder:"Select occupation"})}),(0,r.jsx)(g.Bw,{children:o.YA.map(e=>(0,r.jsx)(g.Ql,{value:e,children:e},e))})]})]})]}),1===Z&&(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 animate-fade-slide",children:[(0,r.jsx)("div",{className:"space-y-2 md:col-span-2",children:(0,r.jsx)(N,{value:U.watch("photoUrl")||null,onChange:e=>U.setValue("photoUrl",e||void 0,{shouldDirty:!0,shouldValidate:!1}),label:"Profile photo"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"province",children:"Province"}),(0,r.jsxs)(g.Ph,{value:U.watch("province"),onValueChange:e=>U.setValue("province",e),children:[(0,r.jsx)(g.i4,{children:(0,r.jsx)(g.ki,{placeholder:"Select province"})}),(0,r.jsx)(g.Bw,{children:o.Fd.map(e=>(0,r.jsx)(g.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"city",children:"District / City"}),(0,r.jsx)(d.I,{id:"city",...U.register("city")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"facilityType",children:"Facility Type"}),(0,r.jsxs)(g.Ph,{value:U.watch("facilityType"),onValueChange:e=>U.setValue("facilityType",e),children:[(0,r.jsx)(g.i4,{children:(0,r.jsx)(g.ki,{placeholder:"Select facility type"})}),(0,r.jsx)(g.Bw,{children:o.tD.map(e=>(0,r.jsx)(g.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{children:"Languages"}),(0,r.jsx)(S.N,{values:U.watch("languages"),options:o.a2.map(e=>({label:e,value:e})),onChange:e=>U.setValue("languages",e)})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{children:"Specialties"}),(0,r.jsx)(S.N,{values:U.watch("specialties"),options:I.map(e=>({label:e,value:e})),onChange:e=>U.setValue("specialties",e)})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{htmlFor:"bioShort",children:"Short bio"}),(0,r.jsx)(m,{id:"bioShort",rows:3,...U.register("bioShort")}),(0,r.jsx)("p",{className:"text-xs text-red-500",children:null===(f=U.formState.errors.bioShort)||void 0===f?void 0:f.message})]})]}),2===Z&&(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 animate-fade-slide",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"mentorshipStyle",children:"Preferred mentorship style"}),(0,r.jsxs)(g.Ph,{value:U.watch("mentorshipStyle")||"Collaborative",onValueChange:e=>U.setValue("mentorshipStyle",e),children:[(0,r.jsx)(g.i4,{children:(0,r.jsx)(g.ki,{placeholder:"Select style"})}),(0,r.jsx)(g.Bw,{children:o.SJ.map(e=>(0,r.jsx)(g.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{htmlFor:"bioLong",children:"Extended bio"}),(0,r.jsx)(m,{id:"bioLong",rows:5,...U.register("bioLong")})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{children:"Meeting modes"}),(0,r.jsx)(S.N,{values:U.watch("meetingModes"),options:[{label:"In-person",value:"In-person"},{label:"Virtual",value:"Virtual"},{label:"Hybrid",value:"Hybrid"}],onChange:e=>U.setValue("meetingModes",e)})]}),"Mentee"!==U.watch("role")&&(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{htmlFor:"mentorCapacity",children:"Mentor capacity"}),(0,r.jsx)(d.I,{id:"mentorCapacity",type:"number",min:1,max:20,...U.register("mentorPreferences.capacity",{valueAsNumber:!0})})]}),"Mentor"!==U.watch("role")&&(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)(v._,{children:"Mentee goals"}),(0,r.jsx)(m,{rows:4,placeholder:"Share your goals, e.g. developing rural rehab pathways, preparing for exit exams\xe2€\xa6",value:(null!==(E=U.watch("menteeGoals"))&&void 0!==E?E:[]).join("\n"),onChange:e=>U.setValue("menteeGoals",e.target.value.split("\n").filter(Boolean))})]})]}),3===Z&&(0,r.jsxs)("div",{className:"space-y-4 animate-fade-slide",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(x,{checked:B,onCheckedChange:e=>{let t=!0===e;U.getValues("consentedPolicies")!==t&&U.setValue("consentedPolicies",t,{shouldDirty:!0,shouldValidate:!0})}}),(0,r.jsx)("div",{className:"space-y-1 text-sm",children:(0,r.jsxs)("p",{children:["I agree to the"," ",(0,r.jsx)("a",{className:"underline",href:"/legal/code-of-conduct",children:"Code of Conduct"}),","," ",(0,r.jsx)("a",{className:"underline",href:"/legal/terms",children:"Terms of Use"})," ","and"," ",(0,r.jsx)("a",{className:"underline",href:"/legal/privacy",children:"Privacy Policy"}),"."]})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,r.jsx)(x,{checked:D,onCheckedChange:e=>{let t=!0===e;U.getValues("ageConfirmed")!==t&&U.setValue("ageConfirmed",t,{shouldDirty:!0,shouldValidate:!0})}}),(0,r.jsx)("span",{children:"I confirm I am 18 years or older."})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(h.z,{type:"button",variant:"ghost",onClick:()=>A(e=>Math.max(e-1,0)),disabled:0===Z,children:"Back"}),Z<R.length-1?(0,r.jsx)(h.z,{type:"button",onClick:()=>void O(),children:"Continue"}):(0,r.jsx)(h.z,{type:"submit",disabled:L.isPending,children:L.isPending?"Saving\xe2€\xa6":"Complete onboarding"})]})]})}},495:function(e,t,a){a.d(t,{z:function(){return c}});var r=a(7437),i=a(2265),l=a(1538),n=a(3027),s=a(4655);let o=(0,n.j)("inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition-all duration-200 ease-out active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-brand-500 text-white shadow-soft hover:bg-brand-600",outline:"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50",ghost:"text-brand-600 hover:bg-brand-50",destructive:"bg-red-600 text-white hover:bg-red-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,t)=>{let{className:a,variant:i,size:n,asChild:c=!1,...d}=e,u=c?l.g7:"button";return(0,r.jsx)(u,{className:(0,s.cn)(o({variant:i,size:n,className:a})),ref:t,...d})});c.displayName="Button"},6013:function(e,t,a){a.d(t,{Zb:function(){return n},aY:function(){return s}});var r=a(7437),i=a(2265),l=a(4655);let n=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-2xl border border-slate-100 bg-white shadow-soft transition duration-300 ease-out will-change-transform hover:-translate-y-0.5 hover:shadow-soft",a),...i})});n.displayName="Card",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("space-y-1.5 p-6",a),...i})}).displayName="CardHeader",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight text-slate-900",a),...i})}).displayName="CardTitle",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-slate-500",a),...i})}).displayName="CardDescription";let s=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...i})});s.displayName="CardContent",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...i})}).displayName="CardFooter"},3102:function(e,t,a){a.d(t,{I:function(){return n}});var r=a(7437),i=a(2265),l=a(4655);let n=i.forwardRef((e,t)=>{let{className:a,type:i,...n}=e;return(0,r.jsx)("input",{type:i,className:(0,l.cn)("flex h-11 w-full rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm shadow-sm transition-all placeholder:text-slate-400 focus-visible:border-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-200",a),ref:t,...n})});n.displayName="Input"},7135:function(e,t,a){a.d(t,{_:function(){return s}});var r=a(7437),i=a(2265),l=a(8364),n=a(4655);let s=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(l.f,{ref:t,className:(0,n.cn)("text-sm font-medium text-slate-700",a),...i})});s.displayName=l.f.displayName},1823:function(e,t,a){a.d(t,{N:function(){return o}});var r=a(7437),i=a(2265),l=a(2468),n=a(495),s=a(4655);function o(e){let{values:t,options:a,onChange:o}=e,c=(0,i.useMemo)(()=>new Set(t),[t]),d=e=>{let t=new Set(c);t.has(e)?t.delete(e):t.add(e),o(Array.from(t))};return(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(e=>{let t=c.has(e.value);return(0,r.jsx)(n.z,{type:"button",variant:t?"default":"outline",size:"sm",onClick:()=>d(e.value),"aria-pressed":t,children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:(0,s.cn)("flex h-3 w-3 items-center justify-center rounded-[4px] border border-slate-300 bg-white text-transparent",t&&"border-brand-500 bg-brand-500 text-white"),children:(0,r.jsx)(l.Z,{className:"h-2.5 w-2.5"})}),(0,r.jsx)("span",{children:e.label})]})},e.value)})})}},6294:function(e,t,a){a.d(t,{Bw:function(){return m},Ph:function(){return c},Ql:function(){return h},i4:function(){return u},ki:function(){return d}});var r=a(7437),i=a(2265),l=a(2851),n=a(2421),s=a(2468),o=a(4655);let c=l.fC;l.ZA;let d=l.B4,u=i.forwardRef((e,t)=>{let{className:a,children:i,...s}=e;return(0,r.jsxs)(l.xz,{ref:t,className:(0,o.cn)("flex h-11 w-full items-center justify-between gap-2 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm shadow-sm transition focus:outline-none focus:ring-2 focus:ring-brand-200 disabled:opacity-50",a),...s,children:[i,(0,r.jsx)(l.JO,{asChild:!0,children:(0,r.jsx)(n.Z,{className:"h-4 w-4 text-slate-500"})})]})});u.displayName=l.xz.displayName;let m=i.forwardRef((e,t)=>{let{className:a,children:i,position:n="popper",...s}=e;return(0,r.jsx)(l.h_,{children:(0,r.jsx)(l.VY,{ref:t,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-2xl border border-slate-100 bg-white shadow-soft animate-in fade-in-0 zoom-in-95","popper"===n&&"translate-y-2",a),position:n,...s,children:(0,r.jsx)(l.l_,{className:"p-2",children:i})})})});m.displayName=l.VY.displayName;let h=i.forwardRef((e,t)=>{let{className:a,children:i,...n}=e;return(0,r.jsxs)(l.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-pointer select-none items-center rounded-xl px-3 py-2 text-sm text-slate-700 outline-none focus:bg-brand-50 focus:text-brand-600 data-[state=checked]:bg-brand-100 data-[state=checked]:text-brand-700",a),...n,children:[(0,r.jsx)(l.eT,{className:"flex-1",children:i}),(0,r.jsx)(l.wU,{className:"absolute right-3 flex items-center",children:(0,r.jsx)(s.Z,{className:"h-4 w-4"})})]})});h.displayName=l.ck.displayName},2738:function(e,t,a){a.d(t,{O:function(){return l}});var r=a(7437),i=a(4655);function l(e){let{className:t}=e;return(0,r.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-2xl bg-slate-200",t)})}},2746:function(e,t,a){a.d(t,{H:function(){return x},a:function(){return g}});var r,i=a(7437),l=a(2265),n=a(5735),s=a(5236);a(9842);var o=a(9854),c=a(357);let d={apiKey:c.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:c.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:c.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:c.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:c.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:c.env.NEXT_PUBLIC_FIREBASE_APP_ID};c.env.FIREBASE_PROJECT_ID||c.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,c.env.FIREBASE_CLIENT_EMAIL,null===(r=c.env.FIREBASE_PRIVATE_KEY)||void 0===r||r.replace(/\\n/g,"\n");let u=!1;var m=a(356),h=a(6463),p=a(2649);let f=(0,l.createContext)(void 0);function x(e){let{children:t}=e,[r,c]=(0,l.useState)(null),[x,g]=(0,l.useState)(!0),v=(0,h.useRouter)(),y=(0,l.useMemo)(()=>m.s?null:(!function(){var e;(0,s.C6)().length||(0,s.ZF)(d);let t=null===(e=window.location)||void 0===e?void 0:e.hostname;if(("localhost"===t||"127.0.0.1"===t)&&!u)try{let e=(0,o.cF)();(0,o.a1)(e,"127.0.0.1",9199),u=!0}catch(e){}}(),(0,n.v0)()),[]);(0,l.useEffect)(()=>{if(m.s){c({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),g(!1);return}if(!y){g(!1);return}let e=(0,n.Aj)(y,async e=>{if(e){var t;let a=await e.getIdTokenResult(),r=await e.getIdToken();try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:r})});e.ok?console.log("post-login successful"):console.error("post-login failed:",e.status,await e.text())}catch(e){console.error("post-login error:",e)}let i=(null===(t=a.claims)||void 0===t?void 0:t.role)==="admin";c({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,isAdmin:i})}else c(null);g(!1)});return()=>e()},[y]);let b=(0,l.useMemo)(()=>({user:r,loading:x,signOutUser:async()=>{if(m.s){p.Z.remove("onboarding"),c(null),v.push("/");return}if(!y)throw Error("Firebase not initialized");await (0,n.w7)(y),await fetch("/api/auth/logout",{method:"POST"}).catch(()=>void 0),p.Z.remove("onboarding"),v.push("/")},sendMagicLink:async(e,t)=>{var a,r,i;if(m.s){let i=e.trim().toLowerCase();window.localStorage.setItem("emailForSignIn",i),window.localStorage.setItem("authFlow",null!==(a=null==t?void 0:t.mode)&&void 0!==a?a:"sign-in"),c({uid:"demo-user-1",email:i,displayName:null!==(r=i.split("@")[0])&&void 0!==r?r:"Demo User",photoURL:null,isAdmin:!0});return}if(!y)throw Error("Firebase not initialized");let l=e.trim(),s=new URL("/complete",window.location.origin),o=null!==(i=null==t?void 0:t.mode)&&void 0!==i?i:"sign-in";s.searchParams.set("mode",o);let d={url:s.toString(),handleCodeInApp:!0};await (0,n.oo)(y,l,d),window.localStorage.setItem("emailForSignIn",l),window.localStorage.setItem("authFlow",o)},signInWithMagicLink:async(e,t)=>{if(m.s){var a;let t=e.trim().toLowerCase();c({uid:"demo-user-1",email:t,displayName:null!==(a=t.split("@")[0])&&void 0!==a?a:"Demo User",photoURL:null,isAdmin:!0}),window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow");return}if(!y)throw Error("Firebase not initialized");let r=e||window.localStorage.getItem("emailForSignIn")||"",i=t||window.location.href;if(!(0,n.JB)(y,i))throw Error("Invalid link");await (0,n.P6)(y,r,i);try{let e=y.currentUser;if(e){let t=await e.getIdToken(!0);try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})});e.ok||console.error("magic link post-login failed:",e.status,await e.text())}catch(e){console.error("magic link post-login error:",e)}}}catch(e){}window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow")},signInWithGoogle:async()=>{if(m.s){c({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),v.push("/discover");return}if(!y)throw Error("Firebase not initialized");let e=new n.hJ;await (0,n.rh)(y,e),await new Promise(e=>setTimeout(e,1e3));try{let{handlePostAuthRedirect:e}=await a.e(833).then(a.bind(a,5833)),t=await e();v.push(t)}catch(e){console.error("Post-auth routing failed:",e),v.push("/discover")}}}),[y,r,x,v]);return(0,i.jsx)(f.Provider,{value:b,children:t})}function g(){let e=(0,l.useContext)(f);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},2904:function(e,t,a){a.d(t,{Fd:function(){return l},SJ:function(){return c},YA:function(){return r},a2:function(){return s},eO:function(){return i},mb:function(){return d},nI:function(){return o},tD:function(){return n}});let r=["Physiotherapist","Occupational Therapist","Pharmacist","Speech Therapist","Audiologist","Dietitian","Radiographer","Medical Laboratory Scientist/Technologist","Clinical Psychologist","Social Worker","Dentistry (Community Service)","Medical Doctor","Other"],i=["Community Service","Post-Community Service","Student Intern (final-year)","Private Sector","Public Sector"],l=["EC","FS","GP","KZN","LP","MP","NW","NC","WC"],n=["Clinic","District Hospital","Regional Hospital","Tertiary Hospital","Rehab Centre","Other"],s=["English","Afrikaans","isiXhosa","isiZulu","Sesotho","Setswana","Sepedi","Xitsonga","Tshivenda","siSwati","Ndebele","Other"],o=["In-person","Virtual","Hybrid"],c=["Directive","Collaborative","Peer-like"],d=["Male","Female"]},356:function(e,t,a){a.d(t,{_:function(){return i},s:function(){return r}});let r=!0,i="/mentor-matcher"},4655:function(e,t,a){a.d(t,{cn:function(){return l}});var r=a(4839),i=a(6164);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,i.m6)((0,r.W)(t))}}}]);