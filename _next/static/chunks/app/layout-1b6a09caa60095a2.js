(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6918:function(e,t,i){Promise.resolve().then(i.t.bind(i,8877,23)),Promise.resolve().then(i.bind(i,1239)),Promise.resolve().then(i.bind(i,3460)),Promise.resolve().then(i.bind(i,5076)),Promise.resolve().then(i.bind(i,3367))},1239:function(e,t,i){"use strict";i.r(t),i.d(t,{BottomNav:function(){return f}});var r=i(7437),a=i(7138),n=i(2265),o=i(6463),l=i(4655),s=i(1005),d=i(1240),u=i(7390),c=i(2022),m=i(2746),h=i(1647);let p=[{href:"/discover",label:"Discover",icon:s.Z},{href:"/matches",label:"Matches",icon:d.Z},{href:"/requests",label:"Requests",icon:u.Z},{href:"/profile",label:"Profile",icon:c.Z}];function f(){let e=(0,o.usePathname)()||"/",{user:t}=(0,m.a)(),[i,s]=(0,n.useState)(0),[d,u]=(0,n.useState)(0);return((0,n.useEffect)(()=>{let e=!1;return async function(){try{let[t,i]=await Promise.all([fetch("/api/requests"),fetch("/api/matches")]);if(!e){if(t.ok){let e=((await t.json()).received||[]).filter(e=>"pending"===(e.status||"").toLowerCase()).length;s(e)}else s(0);if(i.ok){let e=((await i.json()).matches||[]).reduce((e,t)=>e+(t.unreadCount||0),0);u(e)}else u(0)}}catch(t){e||(s(0),u(0))}}(),()=>{e=!0}},[e]),["/signin","/complete","/onboarding","/admin","/legal"].some(t=>e===t||e.startsWith("".concat(t,"/"))))?null:(0,r.jsxs)("nav",{className:"md:hidden fixed inset-x-0 bottom-0 z-50 border-t border-slate-200 bg-gradient-to-t from-white/95 to-white/70 backdrop-blur supports-[backdrop-filter]:bg-white/70",role:"navigation","aria-label":"Primary",children:[(0,r.jsx)("ul",{className:"mx-auto grid max-w-xl grid-cols-4 gap-1 px-2 py-2",children:p.map(n=>{let{href:o,label:s,icon:u}=n,c="/"===o?"/"===e:e===o||e.startsWith("".concat(o,"/"));return(0,r.jsx)("li",{className:"flex justify-center",children:(0,r.jsxs)(a.default,{href:o,className:(0,l.cn)("relative flex w-full flex-col items-center justify-center gap-1 rounded-xl px-3 py-2 text-xs",c?"text-brand-700 font-medium bg-brand-50":"text-slate-600 hover:bg-slate-50"),"aria-current":c?"page":void 0,children:[(0,r.jsxs)("div",{className:"relative",children:["/profile"===o&&((null==t?void 0:t.photoURL)||(null==t?void 0:t.displayName))?(0,r.jsx)(h.q,{src:(null==t?void 0:t.photoURL)||void 0,alt:(null==t?void 0:t.displayName)||(null==t?void 0:t.email)||"Profile",className:(0,l.cn)("h-6 w-6 ring-2 ring-white shadow-soft",c?"ring-brand-200":"")}):(0,r.jsx)(u,{className:(0,l.cn)("h-5 w-5",c?"text-brand-700":"text-slate-600"),"aria-hidden":!0}),"/requests"===o&&i>0&&(0,r.jsx)("span",{className:"absolute -right-2 -top-1 rounded-full bg-brand-600 px-1.5 text-[10px] font-semibold text-white",children:i}),"/matches"===o&&d>0&&(0,r.jsx)("span",{className:"absolute -right-2 -top-1 rounded-full bg-brand-600 px-1.5 text-[10px] font-semibold text-white",children:d})]}),(0,r.jsx)("span",{children:s})]})},o)})}),(0,r.jsx)("div",{className:"h-[calc(env(safe-area-inset-bottom))]"})]})}},3460:function(e,t,i){"use strict";i.d(t,{Providers:function(){return U}});var r=i(7437),a=i(3151),n=i(3191),o=i(2265),l=i(9512),s=i(2746),d=i(356);let u="mentorMatchDemoState:v1";function c(){return new Date().toISOString()}function m(e){return new Date(Date.now()-36e5*e).toISOString()}function h(){var e,t,i;let r={uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0},a={fullName:"Demo User",preferredName:"Demo",email:r.email,phone:"+27 00 000 0000",role:"Mentee",occupation:"Physiotherapist",province:"WC",city:"Cape Town",languages:["English","Xitsonga"],specialties:["Musculoskeletal","Community Rehab"],bioShort:"Community service physio exploring rural rehab pathways and clinical mentorship.",photoUrl:"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?q=80&w=512&auto=format&fit=crop",notifications:{push:!0,email:!0}},n=[{id:"demo-mentor-1",fullName:"Dr. Lindiwe Khumalo",role:"Mentor",occupation:"Occupational Therapist",province:"GP",city:"Johannesburg",specialties:["Paediatrics","Neurology","Mental Health"],languages:["English","Zulu"],bioShort:"Paeds OT with a focus on neurodevelopmental support and caregiver coaching.",photoUrl:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=800&auto=format&fit=crop"},{id:"demo-mentor-2",fullName:"Ayanda Mokoena",role:"Mentor",occupation:"Physiotherapist",province:"EC",city:"Mthatha",specialties:["Cardio-respiratory","Community Rehab","Geriatrics"],languages:["English","Xhosa"],bioShort:"Rural rehab physio passionate about mentorship, systems thinking, and clinician wellbeing.",photoUrl:"https://images.unsplash.com/photo-1524503033411-f9f3a9a6fbb8?q=80&w=800&auto=format&fit=crop"},{id:"demo-mentee-1",fullName:"Sipho Dlamini",role:"Mentee",occupation:"Radiographer",province:"KZN",city:"Durban",specialties:["Radiography"],languages:["English","Zulu"],bioShort:"Newly qualified radiographer looking for guidance on career pathways and leadership.",photoUrl:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?q=80&w=800&auto=format&fit=crop"},{id:"demo-mentor-3",fullName:"Naledi Botha",role:"Mentor",occupation:"Pharmacist",province:"FS",city:"Bloemfontein",specialties:["Hospital Pharmacy","Community Pharmacy"],languages:["English","Afrikaans"],bioShort:"Hospital pharmacist mentoring on medication safety and patient counselling.",photoUrl:"https://images.unsplash.com/photo-1525134479668-1bee5c7c6845?q=80&w=800&auto=format&fit=crop"},{id:"demo-mentor-4",fullName:"Thandi Ndlovu",role:"Mentor",occupation:"Physiotherapist",province:"WC",city:"Cape Town",specialties:["Sports","Musculoskeletal","Rehabilitation"],languages:["English"],bioShort:"Sports physio with an interest in injury prevention and sustainable training.",photoUrl:"https://images.unsplash.com/photo-1524502397800-2eeaad7c3fe5?q=80&w=800&auto=format&fit=crop"}],o=[{id:"demo-req-1",senderUserId:"demo-mentee-1",receiverUserId:r.uid,senderName:"Sipho Dlamini",receiverName:a.fullName,senderEmail:"sipho@example.com",receiverEmail:r.email,message:"Hi! I'm starting in a busy district hospital and would love guidance on staying organised and growing clinically.",goals:["General support"],status:"pending",createdAt:m(6),updatedAt:m(6)},{id:"demo-req-2",senderUserId:r.uid,receiverUserId:"demo-mentor-2",senderName:a.fullName,receiverName:"Ayanda Mokoena",senderEmail:r.email,receiverEmail:"ayanda@example.com",message:"Hi Ayanda — I’m working in community service and would appreciate mentorship on rural rehab workflows and sustainable caseload planning.",goals:["General support"],status:"pending",createdAt:m(30),updatedAt:m(30)}],l=[{id:"demo-match-1",mentorId:"demo-mentor-4",menteeId:r.uid,mentorName:"Thandi Ndlovu",menteeName:a.fullName,mentorPhoto:null!==(t=null===(e=n.find(e=>"demo-mentor-4"===e.id))||void 0===e?void 0:e.photoUrl)&&void 0!==t?t:null,menteePhoto:null!==(i=a.photoUrl)&&void 0!==i?i:null,participants:["demo-mentor-4",r.uid],startedAt:m(72),status:"active",hiddenFor:[]}],s=[{id:"demo-msg-1",matchId:"demo-match-1",senderId:"demo-mentor-4",body:"Welcome! What would you like to focus on in your first month?\n\nWe can start with goal-setting + a simple weekly check-in cadence.",type:"text",createdAt:m(60),readBy:["demo-mentor-4"]},{id:"demo-msg-2",matchId:"demo-match-1",senderId:r.uid,body:"Thanks! I’d love help with safe return-to-play basics and managing time between admin + patients.",type:"text",createdAt:m(58),readBy:[r.uid]},{id:"demo-msg-3",matchId:"demo-match-1",senderId:"demo-mentor-4",body:"Great. Let’s outline a 4-week plan, then I’ll share a simple screening checklist you can reuse.",type:"text",createdAt:m(56),readBy:["demo-mentor-4"]}];return{me:r,profile:a,profilesPublic:n,bookmarks:[],requests:o,matches:l,messages:s,reports:[{id:"demo-report-1",category:"Harassment",details:"User reported repeated unwanted messages in chat.",status:"open"},{id:"demo-report-2",category:"Impersonation",details:"Profile photo appears to be stock imagery; please review verification status.",status:"open"}]}}function p(e){window.localStorage.setItem(u,JSON.stringify(e))}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return new Response(JSON.stringify(e),{status:t,headers:{"Content-Type":"application/json"}})}async function v(e,t){let i=null==t?void 0:t.body;if(!i&&e instanceof Request)try{return await e.clone().json()}catch(e){return null}if(!i)return null;if("string"==typeof i)try{return JSON.parse(i)}catch(e){return null}if("undefined"!=typeof FormData&&i instanceof FormData)return null;if("undefined"!=typeof URLSearchParams&&i instanceof URLSearchParams){let e={};return i.forEach((t,i)=>{e[i]=t}),e}return null}function g(e,t){var i;return null!==(i=e.profilesPublic.find(e=>e.id===t))&&void 0!==i?i:null}function w(e,t,i){var r,a,n,o,l,s,d,u,c,m,h,p,f,v;let w=i.senderUserId===t?null:g(e,i.senderUserId),y=i.receiverUserId===t?null:g(e,i.receiverUserId),b=i.createdAt?Date.parse(i.createdAt):0,N=b>0&&Date.now()-b<1728e5;return{...i,senderPhoto:i.senderUserId===e.me.uid?null!==(l=null===(r=e.profile)||void 0===r?void 0:r.photoUrl)&&void 0!==l?l:null:null!==(s=null==w?void 0:w.photoUrl)&&void 0!==s?s:null,receiverPhoto:i.receiverUserId===e.me.uid?null!==(d=null===(a=e.profile)||void 0===a?void 0:a.photoUrl)&&void 0!==d?d:null:null!==(u=null==y?void 0:y.photoUrl)&&void 0!==u?u:null,senderName:i.senderUserId===e.me.uid?null!==(c=null===(n=e.profile)||void 0===n?void 0:n.fullName)&&void 0!==c?c:e.me.displayName:null!==(h=null!==(m=null==w?void 0:w.fullName)&&void 0!==m?m:i.senderName)&&void 0!==h?h:"User",receiverName:i.receiverUserId===e.me.uid?null!==(p=null===(o=e.profile)||void 0===o?void 0:o.fullName)&&void 0!==p?p:e.me.displayName:null!==(v=null!==(f=null==y?void 0:y.fullName)&&void 0!==f?f:i.receiverName)&&void 0!==v?v:"User",isNew:"pending"===i.status&&i.receiverUserId===t&&N}}async function y(e,t,i,r){var a,n,o,l,s,m,y,b,N,I,x,S,U,P,E,A,T,_,k,j,C,R,q,D,O,F,L,B,M,G,H,Z,J,W,X,z,K,$;let Y=($=e.pathname,d._&&$.startsWith(d._+"/")?$.slice(d._.length):$);if(!Y.startsWith("/api/"))return null;let V=function(){try{let e=window.localStorage.getItem(u);if(!e){let e=h();return window.localStorage.setItem(u,JSON.stringify(e)),e}return JSON.parse(e)}catch(t){let e=h();try{window.localStorage.setItem(u,JSON.stringify(e))}catch(e){}return e}}(),Q=V.me.uid;if("/api/auth/check-email"===Y&&"POST"===t)return f({exists:!0,hasProfile:!0});if("/api/auth/post-login"===Y&&"POST"===t||"/api/auth/logout"===Y&&"POST"===t)return f({status:"ok"});if("/api/profile"===Y&&"GET"===t){let e=V.profile,t=!!(e&&e.fullName&&e.occupation&&e.bioShort);return f({profile:e,hasProfile:t})}if("/api/profile"===Y&&("POST"===t||"PATCH"===t)){let e=null!==(a=await v(i,r))&&void 0!==a?a:{},t={...null!==(n=V.profile)&&void 0!==n?n:{},...e};return p({...V,profile:t,me:{...V.me,displayName:(null==t?void 0:t.preferredName)||(null==t?void 0:t.fullName)||V.me.displayName}}),f({status:"ok"})}if("/api/discovery"===Y&&"GET"===t){let t=e.searchParams,i=V.profilesPublic.slice(),r=t.get("role"),a=t.get("occupation"),n=t.get("province"),o=t.getAll("languages");if(r&&(i=i.filter(e=>e.role===r)),a&&(i=i.filter(e=>e.occupation===a)),n&&(i=i.filter(e=>e.province===n)),o.length){let e=new Set(o);i=i.filter(t=>t.languages.some(t=>e.has(t)))}return f({profiles:i})}if("/api/bookmarks"===Y&&"POST"===t){let e=null!==(o=await v(i,r))&&void 0!==o?o:{},t=null==e?void 0:e.targetUserId;if(!t)return f({error:"targetUserId required"},400);let a=new Set(V.bookmarks);return a.add(t),p({...V,bookmarks:Array.from(a)}),f({status:"ok"})}if("/api/requests"===Y&&"POST"===t){let e=null!==(s=await v(i,r))&&void 0!==s?s:{},t=null==e?void 0:e.receiverUserId,a=null!==(m=null==e?void 0:e.message)&&void 0!==m?m:"",n=Array.isArray(null==e?void 0:e.goals)?e.goals:["General support"];if(!t)return f({error:"receiverUserId required"},400);let o=g(V,t),d={id:"demo-req-".concat(Date.now()),senderUserId:Q,receiverUserId:t,senderName:null!==(y=null===(l=V.profile)||void 0===l?void 0:l.fullName)&&void 0!==y?y:V.me.displayName,receiverName:null!==(b=null==o?void 0:o.fullName)&&void 0!==b?b:"User",senderEmail:V.me.email,receiverEmail:"".concat(t,"@example.com"),message:a,goals:n,status:"pending",createdAt:c(),updatedAt:c()};return p({...V,requests:[d,...V.requests]}),f({id:d.id})}if("/api/requests"===Y&&"GET"===t)return f({sent:V.requests.filter(e=>e.senderUserId===Q).map(e=>w(V,Q,e)),received:V.requests.filter(e=>e.receiverUserId===Q).map(e=>w(V,Q,e))});let ee=Y.match(/^\/api\/requests\/([^/]+)$/);if(ee&&"PATCH"===t){let e;let t=ee[1],a=null!==(N=await v(i,r))&&void 0!==N?N:{},n=null==a?void 0:a.status;if(!new Set(["accepted","declined","withdrawn"]).has(n))return f({error:"Invalid status"},400);let o=V.requests.find(e=>e.id===t);if(!o)return f({error:"Not found"},404);let l={...o,status:n,updatedAt:c()},s=V.matches.slice();if("accepted"===n){e="demo-match-".concat(Date.now());let t=l.receiverUserId,i=l.senderUserId,r=t===Q?null:g(V,t),a=i===Q?null:g(V,i);s=[{id:e,mentorId:t,menteeId:i,mentorName:null!==(E=null==r?void 0:r.fullName)&&void 0!==E?E:t===Q?null!==(P=null===(I=V.profile)||void 0===I?void 0:I.fullName)&&void 0!==P?P:V.me.displayName:"Mentor",menteeName:null!==(T=null==a?void 0:a.fullName)&&void 0!==T?T:i===Q?null!==(A=null===(x=V.profile)||void 0===x?void 0:x.fullName)&&void 0!==A?A:V.me.displayName:"Mentee",mentorPhoto:null!==(k=null==r?void 0:r.photoUrl)&&void 0!==k?k:t===Q&&null!==(_=null===(S=V.profile)||void 0===S?void 0:S.photoUrl)&&void 0!==_?_:null,menteePhoto:null!==(C=null==a?void 0:a.photoUrl)&&void 0!==C?C:i===Q&&null!==(j=null===(U=V.profile)||void 0===U?void 0:U.photoUrl)&&void 0!==j?j:null,participants:[t,i],startedAt:c(),status:"active",hiddenFor:[]},...s]}return p({...V,requests:V.requests.map(e=>e.id===t?l:e),matches:s}),f({status:"ok",matchId:e})}if("/api/matches"===Y&&"GET"===t)return f({matches:V.matches.filter(e=>{var t;return(null!==(t=e.participants)&&void 0!==t?t:[e.mentorId,e.menteeId]).includes(Q)}).map(e=>{var t;return{...e,unreadCount:(t=e.id,V.messages.filter(e=>e.matchId===t&&e.senderId!==Q&&(!Array.isArray(e.readBy)||!e.readBy.includes(Q))).length)}})});let et=Y.match(/^\/api\/matches\/([^/]+)$/);if(et&&"PATCH"===t){let e=et[1],t=null!==(R=await v(i,r))&&void 0!==R?R:{},a=null==t?void 0:t.action,n=V.matches.find(t=>t.id===e);if(!n)return f({error:"Match not found"},404);if(!(null!==(q=n.participants)&&void 0!==q?q:[n.mentorId,n.menteeId]).includes(Q))return f({error:"Forbidden"},403);let o=Array.isArray(n.hiddenFor)?n.hiddenFor.slice():[];if("hide"===a)return o.includes(Q)||o.push(Q),p({...V,matches:V.matches.map(t=>t.id===e?{...t,hiddenFor:o}:t)}),f({status:"hidden"});if("unhide"===a){let t=o.filter(e=>e!==Q);return p({...V,matches:V.matches.map(i=>i.id===e?{...i,hiddenFor:t}:i)}),f({status:"unhidden"})}return f({error:"Invalid action"},400)}if(et&&"DELETE"===t){let e=et[1];return p({...V,matches:V.matches.filter(t=>t.id!==e),messages:V.messages.filter(t=>t.matchId!==e)}),f({status:"deleted"})}let ei=Y.match(/^\/api\/matches\/([^/]+)\/messages$/);if(ei&&"GET"===t){let e=ei[1],t=V.matches.find(t=>t.id===e);if(!t)return f({error:"Match not found"},404);if(!(null!==(B=t.participants)&&void 0!==B?B:[t.mentorId,t.menteeId]).includes(Q))return f({error:"Forbidden"},403);let i=t.mentorId===Q?t.menteeId:t.mentorId,r=i===Q?null:g(V,i);return f({peer:{id:i,name:i===Q?null!==(M=null===(D=V.profile)||void 0===D?void 0:D.fullName)&&void 0!==M?M:V.me.displayName:null!==(G=null==r?void 0:r.fullName)&&void 0!==G?G:"User",photoUrl:i===Q?null!==(H=null===(O=V.profile)||void 0===O?void 0:O.photoUrl)&&void 0!==H?H:null:null!==(Z=null==r?void 0:r.photoUrl)&&void 0!==Z?Z:null},me:{id:Q,name:null!==(J=null===(F=V.profile)||void 0===F?void 0:F.fullName)&&void 0!==J?J:V.me.displayName,photoUrl:null!==(W=null===(L=V.profile)||void 0===L?void 0:L.photoUrl)&&void 0!==W?W:null},messages:V.messages.filter(t=>t.matchId===e).slice().sort((e,t)=>Date.parse(e.createdAt)-Date.parse(t.createdAt))})}if(ei&&"POST"===t){let e=ei[1],t=null!==(X=await v(i,r))&&void 0!==X?X:{},a=null!==(z=null==t?void 0:t.body)&&void 0!==z?z:"",n={id:"demo-msg-".concat(Date.now()),matchId:e,senderId:Q,body:a,type:"text",createdAt:c(),readBy:[Q]};return p({...V,messages:[...V.messages,n]}),f({id:n.id})}let er=Y.match(/^\/api\/matches\/([^/]+)\/messages\/read$/);if(er&&"POST"===t){let e=er[1],t=V.messages.map(t=>{if(t.matchId!==e)return t;let i=Array.isArray(t.readBy)?t.readBy.slice():[];return i.includes(Q)||i.push(Q),{...t,readBy:i}});return p({...V,messages:t}),new Response(null,{status:204})}if("/api/admin/reports"===Y&&"GET"===t)return V.me.isAdmin?f({reports:V.reports}):f({error:"Unauthorized"},401);let ea=Y.match(/^\/api\/admin\/reports\/([^/]+)$/);if(ea&&"PATCH"===t){if(!V.me.isAdmin)return f({error:"Unauthorized"},401);let e=ea[1],t=null!==(K=await v(i,r))&&void 0!==K?K:{},a=V.reports.map(i=>i.id===e?{...i,...t}:i);return p({...V,reports:a}),f({status:"ok"})}return"/api/upload/image"===Y&&"POST"===t?f({url:"https://images.unsplash.com/photo-1544723795-3fb6469f5b39?q=80&w=512&auto=format&fit=crop"}):f({error:"Demo API: Not implemented (".concat(t," ").concat(Y,")")},404)}var b=i(2477),N=i(357);let I=N.env.NEXT_PUBLIC_POSTHOG_KEY,x=N.env.NEXT_PUBLIC_POSTHOG_HOST||"https://app.posthog.com";function S(e){let{children:t}=e;return(0,o.useEffect)(()=>{if(I)return b.ZP.init(I,{api_host:x,capture_pageview:!0,persistence:"localStorage+cookie"}),()=>{b.ZP.stopSessionRecording()}},[]),(0,r.jsx)(r.Fragment,{children:t})}function U(e){let{children:t}=e,[i]=(0,o.useState)(()=>new a.S);return(0,o.useEffect)(()=>{d.s&&function(){if(!d.s)return;let e=window;if(e.__mentorMatchDemoApiInstalled)return;e.__mentorMatchDemoApiInstalled=!0;let t=window.fetch.bind(window);window.fetch=async(e,i)=>{try{let r="string"==typeof e?e:e instanceof Request?e.url:e.toString(),a=new URL(r,window.location.origin),n=((null==i?void 0:i.method)||(e instanceof Request?e.method:"GET")).toUpperCase(),o=await y(a,n,e,i);if(o)return o;return t(e,i)}catch(r){return t(e,i)}}}()},[]),(0,r.jsx)(l.f,{attribute:"class",defaultTheme:"light",enableSystem:!0,children:(0,r.jsx)(S,{children:(0,r.jsx)(n.aH,{client:i,children:(0,r.jsx)(s.H,{children:t})})})})}},5076:function(e,t,i){"use strict";i.r(t),i.d(t,{TopNav:function(){return v}});var r=i(7437),a=i(7138),n=i(2265),o=i(6463),l=i(4655),s=i(1005),d=i(1240),u=i(7390),c=i(2022),m=i(4693),h=i(2746),p=i(1647);let f=[{href:"/discover",label:"Discover",icon:s.Z},{href:"/matches",label:"Matches",icon:d.Z},{href:"/requests",label:"Requests",icon:u.Z},{href:"/profile",label:"Profile",icon:c.Z}];function v(){let e=(0,o.usePathname)()||"/",{user:t}=(0,h.a)(),[i,s]=(0,n.useState)(0),[d,u]=(0,n.useState)(0),[c,v]=(0,n.useState)(0),g=(0,n.useMemo)(()=>["/signin","/complete","/onboarding","/admin","/legal"].some(t=>e===t||e.startsWith("".concat(t,"/"))),[e]);return((0,n.useEffect)(()=>{let e=!1;return async function(){if(!t){s(0),u(0);return}try{let[t,i]=await Promise.all([fetch("/api/requests"),fetch("/api/matches")]);if(!e){if(t.ok){let e=((await t.json()).received||[]).filter(e=>"pending"===(e.status||"").toLowerCase()).length;s(e)}else s(0);if(i.ok){let e=(await i.json()).matches||[];u(e.length);let t=e.reduce((e,t)=>e+(t.unreadCount||0),0);v(t)}else u(0)}}catch(t){e||(s(0),u(0))}}(),()=>{e=!0}},[t,e]),g)?null:(0,r.jsx)("header",{className:"hidden md:block fixed inset-x-0 top-0 z-40 border-b border-slate-200 bg-gradient-to-b from-white/90 to-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/70",children:(0,r.jsxs)("div",{className:"mx-auto flex h-14 max-w-6xl items-center justify-between px-4",children:[(0,r.jsx)(a.default,{href:"/discover",className:"font-semibold text-slate-900",children:(0,r.jsx)("span",{className:"bg-gradient-to-r from-brand-700 to-sand-700 bg-clip-text text-transparent",children:"MentorMatch SA"})}),(0,r.jsx)("nav",{"aria-label":"Primary",children:(0,r.jsx)("ul",{className:"flex items-center gap-2",children:f.map(t=>{let{href:n,label:o,icon:s}=t,u="/"===n?"/"===e:e===n||e.startsWith("".concat(n,"/")),h="/requests"===n?i:"/matches"===n?d:0;return(0,r.jsx)("li",{children:(0,r.jsxs)(a.default,{href:n,className:(0,l.cn)("inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm",u?"bg-brand-50 text-brand-800":"text-slate-700 hover:bg-slate-100"),"aria-current":u?"page":void 0,children:[(0,r.jsx)(s,{className:"h-4 w-4","aria-hidden":!0}),(0,r.jsx)("span",{children:o}),"/requests"===n&&h>0&&(0,r.jsx)(m.C,{className:"ml-1",variant:"default",children:h}),"/matches"===n&&c>0&&(0,r.jsx)(m.C,{className:"ml-1",variant:"default",children:c})]})},n)})})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(null==t?void 0:t.email)&&(0,r.jsx)("span",{className:"hidden text-xs text-slate-500 md:inline",children:t.email}),(0,r.jsx)(a.default,{href:"/profile","aria-label":"Profile",children:(0,r.jsx)(p.q,{src:(null==t?void 0:t.photoURL)||void 0,alt:(null==t?void 0:t.email)||"Profile",className:"h-8 w-8 ring-2 ring-white shadow-soft"})})]})]})})}},1647:function(e,t,i){"use strict";i.d(t,{q:function(){return o}});var r=i(7437);i(2265);var a=i(6648),n=i(4655);function o(e){let{src:t,alt:i,fallback:o,className:l,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("relative flex h-14 w-14 items-center justify-center overflow-hidden rounded-full bg-brand-100 text-brand-700",l),...s,children:t?(0,r.jsx)(a.default,{src:t,alt:i,fill:!0,className:"object-cover",sizes:"56px"}):(0,r.jsx)("span",{className:"text-lg font-semibold",children:null!=o?o:i.substring(0,2).toUpperCase()})})}},4693:function(e,t,i){"use strict";i.d(t,{C:function(){return n}});var r=i(7437),a=i(4655);function n(e){let{className:t,variant:i="default",...n}=e;return(0,r.jsx)("span",{className:(0,a.cn)("inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",{default:"bg-brand-100 text-brand-700",outline:"border border-brand-200 text-brand-700",soft:"bg-slate-100 text-slate-700"}[i],t),...n})}},3367:function(e,t,i){"use strict";i.d(t,{Toaster:function(){return n}});var r=i(7437),a=i(7776);function n(){return(0,r.jsx)(a.x7,{theme:"light",position:"top-center",toastOptions:{classNames:{toast:"rounded-2xl border border-slate-100 shadow-soft bg-white text-slate-900"}}})}},2746:function(e,t,i){"use strict";i.d(t,{H:function(){return v},a:function(){return g}});var r,a=i(7437),n=i(2265),o=i(5735),l=i(5236);i(9842);var s=i(9854),d=i(357);let u={apiKey:d.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:d.env.NEXT_PUBLIC_FIREBASE_APP_ID};d.env.FIREBASE_PROJECT_ID||d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,d.env.FIREBASE_CLIENT_EMAIL,null===(r=d.env.FIREBASE_PRIVATE_KEY)||void 0===r||r.replace(/\\n/g,"\n");let c=!1;var m=i(356),h=i(6463),p=i(2649);let f=(0,n.createContext)(void 0);function v(e){let{children:t}=e,[r,d]=(0,n.useState)(null),[v,g]=(0,n.useState)(!0),w=(0,h.useRouter)(),y=(0,n.useMemo)(()=>m.s?null:(!function(){var e;(0,l.C6)().length||(0,l.ZF)(u);let t=null===(e=window.location)||void 0===e?void 0:e.hostname;if(("localhost"===t||"127.0.0.1"===t)&&!c)try{let e=(0,s.cF)();(0,s.a1)(e,"127.0.0.1",9199),c=!0}catch(e){}}(),(0,o.v0)()),[]);(0,n.useEffect)(()=>{if(m.s){d({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),g(!1);return}if(!y){g(!1);return}let e=(0,o.Aj)(y,async e=>{if(e){var t;let i=await e.getIdTokenResult(),r=await e.getIdToken();try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:r})});e.ok?console.log("post-login successful"):console.error("post-login failed:",e.status,await e.text())}catch(e){console.error("post-login error:",e)}let a=(null===(t=i.claims)||void 0===t?void 0:t.role)==="admin";d({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,isAdmin:a})}else d(null);g(!1)});return()=>e()},[y]);let b=(0,n.useMemo)(()=>({user:r,loading:v,signOutUser:async()=>{if(m.s){p.Z.remove("onboarding"),d(null),w.push("/");return}if(!y)throw Error("Firebase not initialized");await (0,o.w7)(y),await fetch("/api/auth/logout",{method:"POST"}).catch(()=>void 0),p.Z.remove("onboarding"),w.push("/")},sendMagicLink:async(e,t)=>{var i,r,a;if(m.s){let a=e.trim().toLowerCase();window.localStorage.setItem("emailForSignIn",a),window.localStorage.setItem("authFlow",null!==(i=null==t?void 0:t.mode)&&void 0!==i?i:"sign-in"),d({uid:"demo-user-1",email:a,displayName:null!==(r=a.split("@")[0])&&void 0!==r?r:"Demo User",photoURL:null,isAdmin:!0});return}if(!y)throw Error("Firebase not initialized");let n=e.trim(),l=new URL("/complete",window.location.origin),s=null!==(a=null==t?void 0:t.mode)&&void 0!==a?a:"sign-in";l.searchParams.set("mode",s);let u={url:l.toString(),handleCodeInApp:!0};await (0,o.oo)(y,n,u),window.localStorage.setItem("emailForSignIn",n),window.localStorage.setItem("authFlow",s)},signInWithMagicLink:async(e,t)=>{if(m.s){var i;let t=e.trim().toLowerCase();d({uid:"demo-user-1",email:t,displayName:null!==(i=t.split("@")[0])&&void 0!==i?i:"Demo User",photoURL:null,isAdmin:!0}),window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow");return}if(!y)throw Error("Firebase not initialized");let r=e||window.localStorage.getItem("emailForSignIn")||"",a=t||window.location.href;if(!(0,o.JB)(y,a))throw Error("Invalid link");await (0,o.P6)(y,r,a);try{let e=y.currentUser;if(e){let t=await e.getIdToken(!0);try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})});e.ok||console.error("magic link post-login failed:",e.status,await e.text())}catch(e){console.error("magic link post-login error:",e)}}}catch(e){}window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow")},signInWithGoogle:async()=>{if(m.s){d({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),w.push("/discover");return}if(!y)throw Error("Firebase not initialized");let e=new o.hJ;await (0,o.rh)(y,e),await new Promise(e=>setTimeout(e,1e3));try{let{handlePostAuthRedirect:e}=await i.e(833).then(i.bind(i,5833)),t=await e();w.push(t)}catch(e){console.error("Post-auth routing failed:",e),w.push("/discover")}}}),[y,r,v,w]);return(0,a.jsx)(f.Provider,{value:b,children:t})}function g(){let e=(0,n.useContext)(f);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},356:function(e,t,i){"use strict";i.d(t,{_:function(){return a},s:function(){return r}});let r=!0,a="/mentor-matcher"},4655:function(e,t,i){"use strict";i.d(t,{cn:function(){return n}});var r=i(4839),a=i(6164);function n(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,a.m6)((0,r.W)(t))}},8877:function(){}},function(e){e.O(0,[404,358,139,878,868,776,648,913,231,277,616,971,23,744],function(){return e(e.s=6918)}),_N_E=e.O()}]);