(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{6895:function(e,t,n){Promise.resolve().then(n.bind(n,3864))},3864:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(7437),i=n(2265),a=n(6463),o=n(2746),l=n(356),s=n(495),u=n(3102),d=n(7135),c=n(6013),f=n(7776),m=n(4655),p=n(357);let h=[{id:"sign-in",label:"Sign in"},{id:"sign-up",label:"Create profile"}];function g(){let e=(0,a.useRouter)(),[t,n]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[y,w]=(0,i.useState)("sign-in"),[x,b]=(0,i.useState)(!1),[N,E]=(0,i.useState)(""),{sendMagicLink:I,signInWithGoogle:S}=(0,o.a)(),j=e=>{w(e),b(!1)},_=async r=>{r.preventDefault(),v(!0),b(!1);let i=t.trim(),a=i.toLowerCase();try{if(l.s){f.Am.success("Demo mode enabled — signing you in locally."),e.push("/discover");return}if(!i){f.Am.error("Please enter your email address.");return}let t=await fetch("/api/auth/check-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});if(!t.ok){f.Am.error("We could not verify your email. Please try again.");return}let{exists:r,hasProfile:o}=await t.json();if("sign-in"===y&&!r){f.Am.error("We could not find an account for that email. Try creating a profile.");return}if("sign-up"===y&&o){f.Am.error("That email already has a profile. Please sign in instead."),w("sign-in"),n(i);return}await I(a,{mode:y});let s="sign-in"===y?"Sign-in link sent! Check your inbox.":"Welcome! Confirm the email we just sent to start onboarding.";f.Am.success(s),b(!0),E(i),n("")}catch(e){console.error(e),f.Am.error("Unable to send link. Please try again.")}finally{v(!1)}};return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-brand-50 via-white to-sand-100 px-6 py-16",children:(0,r.jsx)(c.Zb,{className:"w-full max-w-md",children:(0,r.jsxs)(c.aY,{className:"space-y-6 p-8",children:[(0,r.jsxs)("div",{className:"space-y-3 text-center",children:[(0,r.jsx)("div",{className:"inline-flex rounded-full bg-brand-100 px-3 py-1 text-xs font-medium text-brand-800",children:"MentorMatch SA"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"sign-in"===y?"Welcome back":"Create your profile"}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"sign-in"===y?"Sign in to manage your profile and mentorship journeys.":"Start your onboarding to join the mentorship community."})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 rounded-lg bg-slate-100 p-1",children:h.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>j(e.id),className:(0,m.cn)("rounded-md px-3 py-2 text-sm font-medium transition-colors",y===e.id?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-white/60"),children:e.label},e.id))}),(0,r.jsxs)("form",{onSubmit:_,className:"space-y-4 text-left",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d._,{htmlFor:"email",children:"Work email"}),(0,r.jsx)(u.I,{id:"email",type:"email",value:t,required:!l.s,onChange:e=>n(e.target.value),placeholder:l.s?"Optional in demo mode":"you@healthmail.co.za"})]}),(0,r.jsx)(s.z,{type:"submit",className:"w-full",disabled:g,children:g?"Sending link…":"sign-in"===y?"Email me a sign-in link":"Send onboarding link"}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:'Didn\'t get the email? Please check your spam or junk folder and mark it as "Not spam".'})]}),x&&(0,r.jsxs)("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700",children:["We sent a secure link to ",(0,r.jsx)("strong",{children:N}),". Open it on this device to ","sign-in"===y?"sign in":"finish onboarding",". If you don't see it, please check your spam/junk folder."]}),"true"===p.env.NEXT_PUBLIC_ENABLE_GOOGLE_OAUTH&&(0,r.jsx)(s.z,{variant:"outline",className:"w-full",onClick:S,children:"Continue with Google"}),(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["By continuing you agree to our"," ",(0,r.jsx)("a",{className:"underline",href:"/legal/terms",children:"Terms of Use"})," ","and"," ",(0,r.jsx)("a",{className:"underline",href:"/legal/privacy",children:"Privacy Policy"}),"."]})]})})})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(7437),i=n(2265),a=n(1538),o=n(3027),l=n(4655);let s=(0,o.j)("inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition-all duration-200 ease-out active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-brand-500 text-white shadow-soft hover:bg-brand-600",outline:"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50",ghost:"text-brand-600 hover:bg-brand-50",destructive:"bg-red-600 text-white hover:bg-red-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=i.forwardRef((e,t)=>{let{className:n,variant:i,size:o,asChild:u=!1,...d}=e,c=u?a.g7:"button";return(0,r.jsx)(c,{className:(0,l.cn)(s({variant:i,size:o,className:n})),ref:t,...d})});u.displayName="Button"},6013:function(e,t,n){"use strict";n.d(t,{Zb:function(){return o},aY:function(){return l}});var r=n(7437),i=n(2265),a=n(4655);let o=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-2xl border border-slate-100 bg-white shadow-soft transition duration-300 ease-out will-change-transform hover:-translate-y-0.5 hover:shadow-soft",n),...i})});o.displayName="Card",i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("space-y-1.5 p-6",n),...i})}).displayName="CardHeader",i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("h3",{ref:t,className:(0,a.cn)("text-lg font-semibold leading-none tracking-tight text-slate-900",n),...i})}).displayName="CardTitle",i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-slate-500",n),...i})}).displayName="CardDescription";let l=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",n),...i})});l.displayName="CardContent",i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",n),...i})}).displayName="CardFooter"},3102:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(7437),i=n(2265),a=n(4655);let o=i.forwardRef((e,t)=>{let{className:n,type:i,...o}=e;return(0,r.jsx)("input",{type:i,className:(0,a.cn)("flex h-11 w-full rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm shadow-sm transition-all placeholder:text-slate-400 focus-visible:border-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-200",n),ref:t,...o})});o.displayName="Input"},7135:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(7437),i=n(2265),a=n(8364),o=n(4655);let l=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)(a.f,{ref:t,className:(0,o.cn)("text-sm font-medium text-slate-700",n),...i})});l.displayName=a.f.displayName},2746:function(e,t,n){"use strict";n.d(t,{H:function(){return g},a:function(){return v}});var r,i=n(7437),a=n(2265),o=n(5735),l=n(5236);n(9842);var s=n(9854),u=n(357);let d={apiKey:u.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:u.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:u.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:u.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:u.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:u.env.NEXT_PUBLIC_FIREBASE_APP_ID};u.env.FIREBASE_PROJECT_ID||u.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,u.env.FIREBASE_CLIENT_EMAIL,null===(r=u.env.FIREBASE_PRIVATE_KEY)||void 0===r||r.replace(/\\n/g,"\n");let c=!1;var f=n(356),m=n(6463),p=n(2649);let h=(0,a.createContext)(void 0);function g(e){let{children:t}=e,[r,u]=(0,a.useState)(null),[g,v]=(0,a.useState)(!0),y=(0,m.useRouter)(),w=(0,a.useMemo)(()=>f.s?null:(!function(){var e;(0,l.C6)().length||(0,l.ZF)(d);let t=null===(e=window.location)||void 0===e?void 0:e.hostname;if(("localhost"===t||"127.0.0.1"===t)&&!c)try{let e=(0,s.cF)();(0,s.a1)(e,"127.0.0.1",9199),c=!0}catch(e){}}(),(0,o.v0)()),[]);(0,a.useEffect)(()=>{if(f.s){u({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),v(!1);return}if(!w){v(!1);return}let e=(0,o.Aj)(w,async e=>{if(e){var t;let n=await e.getIdTokenResult(),r=await e.getIdToken();try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:r})});e.ok?console.log("post-login successful"):console.error("post-login failed:",e.status,await e.text())}catch(e){console.error("post-login error:",e)}let i=(null===(t=n.claims)||void 0===t?void 0:t.role)==="admin";u({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,isAdmin:i})}else u(null);v(!1)});return()=>e()},[w]);let x=(0,a.useMemo)(()=>({user:r,loading:g,signOutUser:async()=>{if(f.s){p.Z.remove("onboarding"),u(null),y.push("/");return}if(!w)throw Error("Firebase not initialized");await (0,o.w7)(w),await fetch("/api/auth/logout",{method:"POST"}).catch(()=>void 0),p.Z.remove("onboarding"),y.push("/")},sendMagicLink:async(e,t)=>{var n,r,i;if(f.s){let i=e.trim().toLowerCase();window.localStorage.setItem("emailForSignIn",i),window.localStorage.setItem("authFlow",null!==(n=null==t?void 0:t.mode)&&void 0!==n?n:"sign-in"),u({uid:"demo-user-1",email:i,displayName:null!==(r=i.split("@")[0])&&void 0!==r?r:"Demo User",photoURL:null,isAdmin:!0});return}if(!w)throw Error("Firebase not initialized");let a=e.trim(),l=new URL("/complete",window.location.origin),s=null!==(i=null==t?void 0:t.mode)&&void 0!==i?i:"sign-in";l.searchParams.set("mode",s);let d={url:l.toString(),handleCodeInApp:!0};await (0,o.oo)(w,a,d),window.localStorage.setItem("emailForSignIn",a),window.localStorage.setItem("authFlow",s)},signInWithMagicLink:async(e,t)=>{if(f.s){var n;let t=e.trim().toLowerCase();u({uid:"demo-user-1",email:t,displayName:null!==(n=t.split("@")[0])&&void 0!==n?n:"Demo User",photoURL:null,isAdmin:!0}),window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow");return}if(!w)throw Error("Firebase not initialized");let r=e||window.localStorage.getItem("emailForSignIn")||"",i=t||window.location.href;if(!(0,o.JB)(w,i))throw Error("Invalid link");await (0,o.P6)(w,r,i);try{let e=w.currentUser;if(e){let t=await e.getIdToken(!0);try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})});e.ok||console.error("magic link post-login failed:",e.status,await e.text())}catch(e){console.error("magic link post-login error:",e)}}}catch(e){}window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow")},signInWithGoogle:async()=>{if(f.s){u({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),y.push("/discover");return}if(!w)throw Error("Firebase not initialized");let e=new o.hJ;await (0,o.rh)(w,e),await new Promise(e=>setTimeout(e,1e3));try{let{handlePostAuthRedirect:e}=await n.e(833).then(n.bind(n,5833)),t=await e();y.push(t)}catch(e){console.error("Post-auth routing failed:",e),y.push("/discover")}}}),[w,r,g,y]);return(0,i.jsx)(h.Provider,{value:x,children:t})}function v(){let e=(0,a.useContext)(h);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},356:function(e,t,n){"use strict";n.d(t,{_:function(){return i},s:function(){return r}});let r=!0,i="/mentor-matcher"},4655:function(e,t,n){"use strict";n.d(t,{cn:function(){return a}});var r=n(4839),i=n(6164);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.m6)((0,r.W)(t))}},1584:function(e,t,n){"use strict";n.d(t,{F:function(){return a},e:function(){return o}});var r=n(2265);function i(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function a(...e){return t=>{let n=!1,r=e.map(e=>{let r=i(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():i(e[t],null)}}}}function o(...e){return r.useCallback(a(...e),e)}},8364:function(e,t,n){"use strict";n.d(t,{f:function(){return l}});var r=n(2265),i=n(5171),a=n(7437),o=r.forwardRef((e,t)=>(0,a.jsx)(i.WV.label,{...e,ref:t,onMouseDown:t=>{var n;t.target.closest("button, input, select, textarea")||(null===(n=e.onMouseDown)||void 0===n||n.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var l=o},5171:function(e,t,n){"use strict";n.d(t,{WV:function(){return l},jH:function(){return s}});var r=n(2265),i=n(4887),a=n(1538),o=n(7437),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let n=(0,a.Z8)(`Primitive.${t}`),i=r.forwardRef((e,r)=>{let{asChild:i,...a}=e,l=i?n:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(l,{...a,ref:r})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function s(e,t){e&&i.flushSync(()=>e.dispatchEvent(t))}},1538:function(e,t,n){"use strict";n.d(t,{Z8:function(){return o},g7:function(){return l}});var r=n(2265),i=n(1584),a=n(7437);function o(e){let t=function(e){let t=r.forwardRef((e,t)=>{let{children:n,...a}=e;if(r.isValidElement(n)){let e,o;let l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?n.props.ref:n.props.ref||n.ref,s=function(e,t){let n={...t};for(let r in t){let i=e[r],a=t[r];/^on[A-Z]/.test(r)?i&&a?n[r]=(...e)=>{let t=a(...e);return i(...e),t}:i&&(n[r]=i):"style"===r?n[r]={...i,...a}:"className"===r&&(n[r]=[i,a].filter(Boolean).join(" "))}return{...e,...n}}(a,n.props);return n.type!==r.Fragment&&(s.ref=t?(0,i.F)(t,l):l),r.cloneElement(n,s)}return r.Children.count(n)>1?r.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=r.forwardRef((e,n)=>{let{children:i,...o}=e,l=r.Children.toArray(i),s=l.find(u);if(s){let e=s.props.children,i=l.map(t=>t!==s?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...o,ref:n,children:r.isValidElement(e)?r.cloneElement(e,void 0,i):null})}return(0,a.jsx)(t,{...o,ref:n,children:i})});return n.displayName=`${e}.Slot`,n}var l=o("Slot"),s=Symbol("radix.slottable");function u(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===s}},3027:function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var r=n(4839);let i=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=r.W,o=(e,t)=>n=>{var r;if((null==t?void 0:t.variants)==null)return a(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:o,defaultVariants:l}=t,s=Object.keys(o).map(e=>{let t=null==n?void 0:n[e],r=null==l?void 0:l[e];if(null===t)return null;let a=i(t)||i(r);return o[e][a]}),u=n&&Object.entries(n).reduce((e,t)=>{let[n,r]=t;return void 0===r||(e[n]=r),e},{});return a(e,s,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:n,className:r,...i}=t;return Object.entries(i).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...l,...u}[t]):({...l,...u})[t]===n})?[...e,n,r]:e},[]),null==n?void 0:n.class,null==n?void 0:n.className)}}},function(e){e.O(0,[358,139,868,776,913,971,23,744],function(){return e(e.s=6895)}),_N_E=e.O()}]);