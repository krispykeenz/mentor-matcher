(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[359],{215:function(e,t,n){Promise.resolve().then(n.bind(n,7879))},7879:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var a=n(7437),r=n(4304),i=n(7138),s=n(6013),l=n(495),o=n(1647),d=n(6463),c=n(2265);function u(e){let{matchId:t,mode:n="active"}=e,r=(0,d.useRouter)(),[i,s]=(0,c.useState)(null),l=async()=>{s("hide");try{(await fetch("/api/matches/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"hide"})})).ok&&r.refresh()}finally{s(null)}},o=async()=>{s("unhide");try{(await fetch("/api/matches/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"unhide"})})).ok&&r.refresh()}finally{s(null)}},u=async()=>{if(window.confirm("Delete this chat for both participants? This removes all messages.")){s("delete");try{(await fetch("/api/matches/".concat(t),{method:"DELETE"})).ok&&r.refresh()}finally{s(null)}}};return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["active"===n?(0,a.jsx)("button",{type:"button",onClick:()=>void l(),disabled:null!==i,className:"rounded-xl border border-slate-300 px-3 py-1.5 text-xs text-slate-600 hover:bg-slate-100",children:"hide"===i?"Hiding…":"Hide"}):(0,a.jsx)("button",{type:"button",onClick:()=>void o(),disabled:null!==i,className:"rounded-xl border border-brand-300 px-3 py-1.5 text-xs text-brand-700 hover:bg-brand-50",children:"unhide"===i?"Restoring…":"Unhide"}),(0,a.jsx)("button",{type:"button",onClick:()=>void u(),disabled:null!==i,className:"rounded-xl border border-red-300 px-3 py-1.5 text-xs text-red-600 hover:bg-red-50",children:"delete"===i?"Deleting…":"Delete"})]})}var m=n(2746);let h=async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to load matches");return t.json()};function f(){var e;let{user:t,loading:n}=(0,m.a)(),{data:d}=(0,r.ZP)(t?"/api/matches":null,h,{refreshInterval:1e4});if(n)return(0,a.jsx)("p",{className:"mt-6 text-sm text-slate-500",children:"Loading matches…"});if(!t)return(0,a.jsx)("div",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 text-sm text-slate-600",children:"Please sign in to view your mentorship matches."});let c=null!==(e=null==d?void 0:d.matches)&&void 0!==e?e:[],f=t.uid,x=e=>Array.isArray(e.hiddenFor)?e.hiddenFor:[],p=c.filter(e=>!x(e).includes(f)),v=c.filter(e=>x(e).includes(f));return(0,a.jsxs)("div",{className:"mt-6 grid gap-8",children:[(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-600",children:"Active"}),0===p.length?(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 text-center",children:[(0,a.jsx)("img",{src:"https://images.unsplash.com/photo-1519710164239-da123dc03ef4?q=80&w=1200&auto=format&fit=crop",alt:"Warm coffee and notebook",className:"mx-auto mb-4 h-28 w-28 rounded-2xl object-cover shadow-soft",loading:"lazy"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"No active mentorships yet. Start by discovering matches."})]}):(0,a.jsx)("div",{className:"grid gap-4",children:p.map(e=>{var t,n,r,d;return(0,a.jsx)(s.Zb,{children:(0,a.jsxs)(s.aY,{className:"flex items-center justify-between p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center -space-x-2",children:[(0,a.jsx)(o.q,{src:e.mentorPhoto,alt:null!==(t=e.mentorName)&&void 0!==t?t:"Mentor",className:"h-10 w-10 ring-2 ring-white"}),(0,a.jsx)(o.q,{src:e.menteePhoto,alt:null!==(n=e.menteeName)&&void 0!==n?n:"Mentee",className:"h-10 w-10 ring-2 ring-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-900",children:[null!==(r=e.mentorName)&&void 0!==r?r:"Mentor"," & ",null!==(d=e.menteeName)&&void 0!==d?d:"Mentee"]}),(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.status})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["number"==typeof e.unreadCount&&e.unreadCount>0&&(0,a.jsxs)("span",{className:"rounded-full bg-brand-100 px-2 py-1 text-xs font-semibold text-brand-700",children:[e.unreadCount," new"]}),(0,a.jsx)(l.z,{asChild:!0,children:(0,a.jsx)(i.default,{href:"/chat/".concat(e.id),children:"Open chat"})}),(0,a.jsx)(u,{matchId:e.id,mode:"active"})]})]})},e.id)})})]}),(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-600",children:"Archived"}),0===v.length?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"No archived chats."}):(0,a.jsx)("div",{className:"grid gap-4",children:v.map(e=>{var t,n,r,i;return(0,a.jsx)(s.Zb,{children:(0,a.jsxs)(s.aY,{className:"flex items-center justify-between p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center -space-x-2",children:[(0,a.jsx)(o.q,{src:e.mentorPhoto,alt:null!==(t=e.mentorName)&&void 0!==t?t:"Mentor",className:"h-10 w-10 ring-2 ring-white"}),(0,a.jsx)(o.q,{src:e.menteePhoto,alt:null!==(n=e.menteeName)&&void 0!==n?n:"Mentee",className:"h-10 w-10 ring-2 ring-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-900",children:[null!==(r=e.mentorName)&&void 0!==r?r:"Mentor"," & ",null!==(i=e.menteeName)&&void 0!==i?i:"Mentee"]}),(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.status})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(u,{matchId:e.id,mode:"archived"})})]})},e.id)})})]})]})}function x(){return(0,a.jsx)("div",{className:"min-h-screen bg-sand-50",children:(0,a.jsxs)("div",{className:"mx-auto w-full max-w-5xl px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Active mentorships"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Manage and continue conversations with your mentors and mentees."}),(0,a.jsx)(f,{})]})})}},1647:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var a=n(7437);n(2265);var r=n(6648),i=n(4655);function s(e){let{src:t,alt:n,fallback:s,className:l,...o}=e;return(0,a.jsx)("div",{className:(0,i.cn)("relative flex h-14 w-14 items-center justify-center overflow-hidden rounded-full bg-brand-100 text-brand-700",l),...o,children:t?(0,a.jsx)(r.default,{src:t,alt:n,fill:!0,className:"object-cover",sizes:"56px"}):(0,a.jsx)("span",{className:"text-lg font-semibold",children:null!=s?s:n.substring(0,2).toUpperCase()})})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return d}});var a=n(7437),r=n(2265),i=n(1538),s=n(3027),l=n(4655);let o=(0,s.j)("inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition-all duration-200 ease-out active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-brand-500 text-white shadow-soft hover:bg-brand-600",outline:"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50",ghost:"text-brand-600 hover:bg-brand-50",destructive:"bg-red-600 text-white hover:bg-red-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:n,variant:r,size:s,asChild:d=!1,...c}=e,u=d?i.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:r,size:s,className:n})),ref:t,...c})});d.displayName="Button"},6013:function(e,t,n){"use strict";n.d(t,{Zb:function(){return s},aY:function(){return l}});var a=n(7437),r=n(2265),i=n(4655);let s=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-2xl border border-slate-100 bg-white shadow-soft transition duration-300 ease-out will-change-transform hover:-translate-y-0.5 hover:shadow-soft",n),...r})});s.displayName="Card",r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("space-y-1.5 p-6",n),...r})}).displayName="CardHeader",r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight text-slate-900",n),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-slate-500",n),...r})}).displayName="CardDescription";let l=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",n),...r})});l.displayName="CardContent",r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",n),...r})}).displayName="CardFooter"},2746:function(e,t,n){"use strict";n.d(t,{H:function(){return p},a:function(){return v}});var a,r=n(7437),i=n(2265),s=n(5735),l=n(5236);n(9842);var o=n(9854),d=n(357);let c={apiKey:d.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:d.env.NEXT_PUBLIC_FIREBASE_APP_ID};d.env.FIREBASE_PROJECT_ID||d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,d.env.FIREBASE_CLIENT_EMAIL,null===(a=d.env.FIREBASE_PRIVATE_KEY)||void 0===a||a.replace(/\\n/g,"\n");let u=!1;var m=n(356),h=n(6463),f=n(2649);let x=(0,i.createContext)(void 0);function p(e){let{children:t}=e,[a,d]=(0,i.useState)(null),[p,v]=(0,i.useState)(!0),g=(0,h.useRouter)(),w=(0,i.useMemo)(()=>m.s?null:(!function(){var e;(0,l.C6)().length||(0,l.ZF)(c);let t=null===(e=window.location)||void 0===e?void 0:e.hostname;if(("localhost"===t||"127.0.0.1"===t)&&!u)try{let e=(0,o.cF)();(0,o.a1)(e,"127.0.0.1",9199),u=!0}catch(e){}}(),(0,s.v0)()),[]);(0,i.useEffect)(()=>{if(m.s){d({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),v(!1);return}if(!w){v(!1);return}let e=(0,s.Aj)(w,async e=>{if(e){var t;let n=await e.getIdTokenResult(),a=await e.getIdToken();try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:a})});e.ok?console.log("post-login successful"):console.error("post-login failed:",e.status,await e.text())}catch(e){console.error("post-login error:",e)}let r=(null===(t=n.claims)||void 0===t?void 0:t.role)==="admin";d({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,isAdmin:r})}else d(null);v(!1)});return()=>e()},[w]);let b=(0,i.useMemo)(()=>({user:a,loading:p,signOutUser:async()=>{if(m.s){f.Z.remove("onboarding"),d(null),g.push("/");return}if(!w)throw Error("Firebase not initialized");await (0,s.w7)(w),await fetch("/api/auth/logout",{method:"POST"}).catch(()=>void 0),f.Z.remove("onboarding"),g.push("/")},sendMagicLink:async(e,t)=>{var n,a,r;if(m.s){let r=e.trim().toLowerCase();window.localStorage.setItem("emailForSignIn",r),window.localStorage.setItem("authFlow",null!==(n=null==t?void 0:t.mode)&&void 0!==n?n:"sign-in"),d({uid:"demo-user-1",email:r,displayName:null!==(a=r.split("@")[0])&&void 0!==a?a:"Demo User",photoURL:null,isAdmin:!0});return}if(!w)throw Error("Firebase not initialized");let i=e.trim(),l=new URL("/complete",window.location.origin),o=null!==(r=null==t?void 0:t.mode)&&void 0!==r?r:"sign-in";l.searchParams.set("mode",o);let c={url:l.toString(),handleCodeInApp:!0};await (0,s.oo)(w,i,c),window.localStorage.setItem("emailForSignIn",i),window.localStorage.setItem("authFlow",o)},signInWithMagicLink:async(e,t)=>{if(m.s){var n;let t=e.trim().toLowerCase();d({uid:"demo-user-1",email:t,displayName:null!==(n=t.split("@")[0])&&void 0!==n?n:"Demo User",photoURL:null,isAdmin:!0}),window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow");return}if(!w)throw Error("Firebase not initialized");let a=e||window.localStorage.getItem("emailForSignIn")||"",r=t||window.location.href;if(!(0,s.JB)(w,r))throw Error("Invalid link");await (0,s.P6)(w,a,r);try{let e=w.currentUser;if(e){let t=await e.getIdToken(!0);try{let e=await fetch("/api/auth/post-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})});e.ok||console.error("magic link post-login failed:",e.status,await e.text())}catch(e){console.error("magic link post-login error:",e)}}}catch(e){}window.localStorage.removeItem("emailForSignIn"),window.localStorage.removeItem("authFlow")},signInWithGoogle:async()=>{if(m.s){d({uid:"demo-user-1",email:"demo@mentormatch.local",displayName:"Demo User",photoURL:null,isAdmin:!0}),g.push("/discover");return}if(!w)throw Error("Firebase not initialized");let e=new s.hJ;await (0,s.rh)(w,e),await new Promise(e=>setTimeout(e,1e3));try{let{handlePostAuthRedirect:e}=await n.e(833).then(n.bind(n,5833)),t=await e();g.push(t)}catch(e){console.error("Post-auth routing failed:",e),g.push("/discover")}}}),[w,a,p,g]);return(0,r.jsx)(x.Provider,{value:b,children:t})}function v(){let e=(0,i.useContext)(x);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},356:function(e,t,n){"use strict";n.d(t,{_:function(){return r},s:function(){return a}});let a=!0,r="/mentor-matcher"},4655:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var a=n(4839),r=n(6164);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}},7138:function(e,t,n){"use strict";n.d(t,{default:function(){return r.a}});var a=n(231),r=n.n(a)},3027:function(e,t,n){"use strict";n.d(t,{j:function(){return s}});var a=n(4839);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=a.W,s=(e,t)=>n=>{var a;if((null==t?void 0:t.variants)==null)return i(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:s,defaultVariants:l}=t,o=Object.keys(s).map(e=>{let t=null==n?void 0:n[e],a=null==l?void 0:l[e];if(null===t)return null;let i=r(t)||r(a);return s[e][i]}),d=n&&Object.entries(n).reduce((e,t)=>{let[n,a]=t;return void 0===a||(e[n]=a),e},{});return i(e,o,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:n,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...l,...d}[t]):({...l,...d})[t]===n})?[...e,n,a]:e},[]),null==n?void 0:n.class,null==n?void 0:n.className)}}},function(e){e.O(0,[358,139,868,32,648,913,231,971,23,744],function(){return e(e.s=215)}),_N_E=e.O()}]);